# MESA (Multi-Entity Simulation Architecture) - 日本語版

AI搭載の住民が現実的な行動、相互作用、意思決定プロセスで日常生活を送る仮想都市を作成する3D自律エージェントシミュレーションです。

[![](https://img.youtube.com/vi/5NguBippS0c/0.jpg)](https://www.youtube.com/watch?v=5NguBippS0c)

## 概要

このアプリケーションは、独自の性格、日常的なルーティン、AI言語モデルを使用した意思決定能力を持つ自律エージェント（住民）が住む小さな都市をシミュレートします。シミュレーションはThree.jsで構築された3D環境で実行され、道路、建物、施設を含む手続き的に生成された都市レイアウトを特徴としています。

## 機能

### 🤖 自律エージェント
- **AI駆動の意思決定**: 各エージェントはOpenAIまたはGemini APIを使用して、性格と現在の状況に基づいて現実的な決定を行います
- **独自の性格**: エージェントは社交性、エネルギーレベル、ルーティン嗜好、好奇心、共感力などの明確な特徴を持っています
- **メモリシステム**: 将来の決定に影響を与える短期および長期メモリシステム
- **関係性ダイナミクス**: エージェントは相互作用を通じてお互いとの関係を構築します
- **日常ルーティン**: 各エージェントは朝、午後、夕方、夜の異なる活動を含む個別化された日常スケジュールに従います
- **コミュニケーションシステム**: エージェントはお互いに電話をかけたりメールを送ったりして、社会的相互作用を強化できます

### 🏙️ 仮想都市環境
- **手続き的都市生成**: 道路、建物、施設を自動的に生成します
- **経路探索システム**: エージェントはA*経路探索アルゴリズムを使用して道路ネットワークをナビゲートします
- **多様な施設**: カフェ、公園、図書館、ジム、学校、病院、スーパーマーケットなど
- **3D視覚化**: 建物、道路、キャラクターモデルを含む現実的な3D環境

### 🎮 インタラクティブコントロール
- **カメラモード**: 
  - 概要のためのフリーカメラ
  - 個別の住民を観察するためのエージェント追従カメラ
  - 特定の場所を監視するための施設フォーカスカメラ
- **時間制御**: 調整可能なシミュレーション速度（1x、2x、4x、8x）
  - リアルタイムの昼夜サイクル
  - 時間はエージェントの行動と環境に影響します
- **エージェント生成**: AI生成された性格を持つ新しいエージェントを作成
- **道路視覚化**: 道路ネットワーク表示と経路視覚化の切り替え

### 📊 リアルタイム監視
- **アクティビティログ**: すべてのエージェントの活動と相互作用の詳細ログ
- **エージェント情報パネル**: 各エージェントの現在のステータス、思考、関係性を表示
- **ライブ更新**: エージェントの位置、気分、活動のリアルタイム表示
- **コミュニケーションログ**: エージェント間の電話とメールのやり取りを追跡

## はじめに

### 前提条件
- WebGLをサポートするモダンなWebブラウザ
- OpenAI APIキーまたはGoogle Gemini APIアクセス

### インストール

#### Webブラウザ版
1. このリポジトリをクローンまたはダウンロードします
2. プロジェクトディレクトリでターミナルを開きます
3. ローカルHTTPサーバーを開始します：
   ```bash
   python3 -m http.server
   ```
4. ブラウザを開いて `http://localhost:8000` に移動します

#### Electronアプリ版
1. このリポジトリをクローンまたはダウンロードします
2. プロジェクトディレクトリでターミナルを開きます
3. 依存パッケージをインストールします：
   ```bash
   npm install
   ```
4. Electronアプリを起動します：
   ```bash
   npx electron .
   ```

### セットアップ
1. コントロールパネルでOpenAI APIキーを入力します
2. 希望するAIプロバイダー（OpenAIまたはGemini）を選択します
3. 「シミュレーション開始」をクリックして開始します

## 動作原理

### エージェントの意思決定
各エージェントは継続的に：
1. **観察**：環境と近くのエージェントを観察します
2. **思考**：AI言語モデルを使用して現在の状況について考えます
3. **決定**：性格、メモリ、関係性に基づいて行動を決定します
4. **実行**：決定を実行します（移動、相互作用、活動の実行、コミュニケーション）
5. **更新**：メモリと関係性を更新します

### コミュニケーションシステム
エージェントは以下の方法でコミュニケーションできます：
- **電話**: エージェント間の直接的な音声コミュニケーション
- **メール**: 長いメッセージや正式な相互作用のための文章コミュニケーション
- **ソーシャルメディア**: シミュレートされたソーシャルプラットフォームを通じたデジタル相互作用

### 都市レイアウト
都市は手続き的に生成され、以下を含みます：
- **メインストリート**: 主要エリアを接続する主要道路
- **サブストリート**: 市街区画内の二次道路
- **建物**: 様々なタイプ（住宅、商業、公共施設）
- **交差点**: 経路探索のための交通ノード

### 時間システム
シミュレーションは現実的な時間システムを特徴とします：
- **昼夜サイクル**: 照明とエージェントの行動に影響します
- **時間ベースの活動**: エージェントは時間帯に基づいて異なるルーティンに従います
- **環境変化**: 都市の雰囲気は一日を通して変化します

## 技術詳細

### アーキテクチャ
- **フロントエンド**: HTML5、CSS3、JavaScript（ES6+）
- **3Dグラフィックス**: 3Dレンダリング用のThree.js
- **AI統合**: OpenAI GPTとGoogle Gemini API
- **経路探索**: ナビゲーション用のA*アルゴリズム
- **メモリ管理**: エージェント永続性のためのカスタムメモリシステム
- **コミュニケーション**: シミュレートされた電話とメールシステム

### 主要コンポーネント
- `agent.js`: コアエージェントロジックとAI意思決定
- `citylayout.js`: 都市生成と経路探索
- `main.js`: メインシミュレーションループとコントロール
- `config.js`: エージェントの性格と都市設定
- `character.js`: 3Dキャラクターモデルとアニメーション
- `communication.js`: 電話とメールコミュニケーションシステム

## カスタマイズ

### 新しいエージェントの追加
`config.js`の`agentPersonalities`配列を修正するか、インターフェースの「新しいエージェント生成」ボタンを使用して、カスタム性格を持つ新しいエージェントを作成できます。

### 都市レイアウトの修正
`citylayout.js`で都市生成パラメータを調整します：
- グリッドサイズと道路密度
- 建物タイプと配置ルール
- 施設の場所と活動

### エージェント行動の拡張
以下を修正してエージェントの能力を強化します：
- 性格特性とその効果
- 相互作用タイプと結果
- メモリシステムと関係性ダイナミクス
- コミュニケーションパターンと嗜好

## API使用法

アプリケーションは現実的なエージェント意思決定のためにAI APIを使用します。APIキーは保存されず、リアルタイムリクエストでのみ使用されます。

### サポートされているプロバイダー
- **OpenAI GPT**: 包括的な推論機能を持つデフォルトプロバイダー
- **Google Gemini**: エージェント意思決定のための代替プロバイダー
- **Ollama (ローカル)**: プライバシー重視のローカルAIモデル

### Ollamaを使用したローカルAIセットアップ

#### インストール
1. **Ollamaのインストール**:
   ```bash
   # macOS
   curl -fsSL https://ollama.ai/install.sh | sh
   
   # Linux
   curl -fsSL https://ollama.ai/install.sh | sh
   
   # Windows
   # https://ollama.ai/download からダウンロード
   ```

2. **Ollamaサービスの起動**:
   ```bash
   ollama serve
   ```

3. **モデルのダウンロードと実行**:
   ```bash
   # llama3.2をダウンロード（推奨）
   ollama pull llama3.2
   
   # 他のモデルも試せます
   ollama pull llama3.1
   ollama pull mistral
   ollama pull codellama
   ```

#### MESAからの接続
1. **ローカルプロバイダーの選択**: API設定タブで「Ollama (ローカル)」を選択
2. **接続設定**:
   - **URL**: `http://localhost:11434`（デフォルト）
   - **モデル**: `llama3.2`（またはお好みのモデル）
3. **シミュレーション開始**: アプリケーションがローカルAIモデルを使用します

#### ローカルAIの利点
- **プライバシー**: 外部サーバーにデータを送信しません
- **コスト**: API使用料がかかりません
- **カスタマイズ**: Ollamaで利用可能な任意のモデルを使用できます
- **オフライン**: インターネット接続なしで動作します

## 貢献

以下の方法でこのプロジェクトに貢献できます：
- 新しいエージェント性格タイプの追加
- 追加の施設と活動の実装
- 経路探索アルゴリズムの改善
- 3D視覚化の強化
- エージェント間の新しい相互作用タイプの追加
- コミュニケーション機能の拡張

## TODO

### 計画中の機能
- **MCP（Model Context Protocol）統合**: MCPを通じて複数のアプリケーションやサービスに接続
  - スケジューリングのためのカレンダー統合
  - 現実的な環境効果のための天気API統合
  - エージェントの行動に影響する現在のイベントのためのニュースAPI
  - デジタル相互作用のためのソーシャルメディアAPI統合
  - 外部コミュニケーションのためのメールサービス統合
- **高度なコミュニケーション**: 
  - ビデオ通話機能
  - グループチャット機能
  - 音声メッセージシステム
- **高度なAI機能**:
  - マルチモーダルAI（テキスト、音声、画像理解）
  - 感情認識と応答
  - 時間経過による学習と適応

## 謝辞

- 3Dグラフィックス機能のためのThree.jsコミュニティ
- AI言語モデルAPIのためのOpenAIとGoogle
- このシミュレーションで使用される様々なアルゴリズムと技術のためのオープンソースコミュニティ 